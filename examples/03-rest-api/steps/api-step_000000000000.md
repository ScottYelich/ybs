# Step 0: Build Configuration

**Step ID**: 000000000000
**System**: rest-api-client
**Version**: 1.0.0
**Estimated Time**: 3 minutes

---

## Context

**What**: Collect all build configuration questions upfront and save to BUILD_CONFIG.json

**Why**: This enables autonomous execution of Steps 1-6 without user prompts. It also enables zero-interaction rebuilds (subsequent builds read the config file instead of asking questions).

**Step 0 is special**: This is the only step that prompts the user. All subsequent steps read from BUILD_CONFIG.json.

---

## Prerequisites

- None (this is always the first step)

---

## Instructions

### 1. Check for Existing Configuration

**IMPORTANT**: Before asking questions, check if BUILD_CONFIG.json already exists:

```bash
# Check current directory for BUILD_CONFIG.json
if [ -f BUILD_CONFIG.json ]; then
  echo "✅ BUILD_CONFIG.json found - skipping questions"
  cat BUILD_CONFIG.json
  exit 0
fi
```

**If BUILD_CONFIG.json exists**:
- Read it
- Display the configuration
- Skip all questions below
- Mark this step complete
- Proceed to Step 1

**If BUILD_CONFIG.json does NOT exist**:
- Continue with questions below

---

### 2. Scan for CONFIG Markers

Read all step files in the steps/ directory and identify CONFIG markers:
- `{{CONFIG:build_name}}` - Build name
- `{{CONFIG:language}}` - Programming language
- `{{CONFIG:api_base_url}}` - API base URL
- `{{CONFIG:default_endpoint}}` - Default endpoint
- `{{CONFIG:json_indent}}` - JSON indentation
- `{{CONFIG:timeout}}` - Request timeout

---

### 3. Ask Configuration Questions

Prompt the user for each configuration item:

**Q1: Build Name**
```
Question: What should we name this build?
Type: text
Default: demo
Validation: Alphanumeric, hyphens, underscores only ([a-zA-Z0-9_-]+)
CONFIG: build_name
```

**Q2: Programming Language**
```
Question: Which programming language?
Type: choice
Options:
  - python (Python 3.6+ with requests library)
  - javascript (Node.js 12+ with built-in https)
  - ruby (Ruby 2.5+ with net/http)
Default: python
CONFIG: language
```

**Q3: API Base URL**
```
Question: API base URL?
Type: text
Default: https://jsonplaceholder.typicode.com
Note: JSONPlaceholder is a free fake REST API service
CONFIG: api_base_url
```

**Q4: Default Endpoint**
```
Question: Default endpoint to query?
Type: choice
Options:
  - posts (Blog posts - 100 items)
  - users (User accounts - 10 items)
  - todos (Todo items - 200 items)
  - comments (Post comments - 500 items)
Default: posts
CONFIG: default_endpoint
```

**Q5: JSON Indentation**
```
Question: JSON output indentation (spaces)?
Type: choice
Options:
  - 2 (2 spaces - compact)
  - 4 (4 spaces - spacious)
Default: 2
CONFIG: json_indent
```

**Q6: Request Timeout**
```
Question: HTTP request timeout (seconds)?
Type: number
Default: 10
Validation: 1-60 seconds
Note: Prevents hanging on slow connections
CONFIG: timeout
```

---

### 4. Create BUILD_CONFIG.json

Write all collected configuration to BUILD_CONFIG.json:

```json
{
  "system": "rest-api-client",
  "version": "1.0.0",
  "build_name": "{{CONFIG:build_name}}",
  "language": "{{CONFIG:language}}",
  "api_base_url": "{{CONFIG:api_base_url}}",
  "default_endpoint": "{{CONFIG:default_endpoint}}",
  "json_indent": {{CONFIG:json_indent}},
  "timeout": {{CONFIG:timeout}}
}
```

**File Location**: Save to current working directory as `BUILD_CONFIG.json`

---

### 5. Display Configuration Summary

After saving BUILD_CONFIG.json, display a summary:

```
✅ Build Configuration Complete

System: rest-api-client
Build Name: {{CONFIG:build_name}}
Language: {{CONFIG:language}}
API Base URL: {{CONFIG:api_base_url}}
Default Endpoint: {{CONFIG:default_endpoint}}
JSON Indent: {{CONFIG:json_indent}} spaces
Timeout: {{CONFIG:timeout}} seconds

Configuration saved to: BUILD_CONFIG.json

Next: Step 1 (Initialize Project Structure)
```

---

## Verification

**This step is complete when:**
- ✅ BUILD_CONFIG.json exists in current directory
- ✅ File contains valid JSON
- ✅ All required fields present (system, version, build_name, language, api_base_url, default_endpoint, json_indent, timeout)
- ✅ Values match user's answers

**Verification Command**:
```bash
# Validate JSON syntax
python3 -m json.tool BUILD_CONFIG.json > /dev/null && echo "✅ Valid JSON" || echo "❌ Invalid JSON"

# Check required fields
jq -e '.system, .build_name, .language, .api_base_url' BUILD_CONFIG.json > /dev/null && echo "✅ All fields present" || echo "❌ Missing fields"
```

---

## Troubleshooting

**Problem**: User enters invalid build name (special characters)
**Solution**: Re-prompt with validation message, show allowed pattern

**Problem**: jq not installed for validation
**Solution**: Skip jq validation, rely on manual review

**Problem**: User wants to change configuration after creation
**Solution**: Delete BUILD_CONFIG.json and re-run Step 0

---

## References

- **Specification**: [../specs/rest-api-client-spec.md](../specs/rest-api-client-spec.md) § 3.1
- **YBS Framework**: [../../framework/methodology/executing-builds.md](../../framework/methodology/executing-builds.md)
- **Step 0 Template**: [../../framework/templates/step-template.md](../../framework/templates/step-template.md)

---

**End of Step 0**
