# Step 0: Build Configuration

**System**: calculator
**Step ID**: calc-step_000000000000
**Implements**: calculator-spec.md Â§ 4.1 (Build Configuration)
**Prerequisites**: None
**Duration**: 5-10 minutes

---

## Purpose

Collect all configuration parameters needed for the calculator build. This step asks the user for their preferences once, stores them in `BUILD_CONFIG.json`, and enables fully autonomous execution of subsequent steps.

---

## Inputs

No inputs required. This is the first step.

---

## Outputs

- `BUILD_CONFIG.json` - Complete build configuration
- `BUILD_STATUS.md` - Initial build status tracking file

---

## Instructions

### 1. Check for Existing Configuration

**IMPORTANT**: Before asking questions, check if BUILD_CONFIG.json already exists:

```bash
if [ -f BUILD_CONFIG.json ]; then
  echo "âœ… BUILD_CONFIG.json found - skipping questions"
  cat BUILD_CONFIG.json
  exit 0
fi
```

**If BUILD_CONFIG.json exists**: Skip all questions below, display the config, and exit.

**If BUILD_CONFIG.json does NOT exist**: Continue with questions below.

---

### 2. Collect Configuration Parameters

Ask the user for each configuration parameter. Present clear options and defaults.

#### C1: Build Name

**Question**: "What would you like to name this build?"

**Prompt**:
```
Build Name (default: demo):
Examples: demo, build1, test3, prod
```

**Validation**:
- Must be alphanumeric (letters, numbers, hyphens, underscores only)
- Length: 1-50 characters

**Store as**: `build_name`

**Default**: `demo`

---

#### C2: Programming Language

**Question**: "Which programming language would you like to use?"

**Prompt**:
```
Programming Language:
1. python    - Python 3.8+ with pytest
2. javascript - Node.js with Jest

Enter choice (1-2, default: 1):
```

**Validation**:
- Must be 1 or 2
- Map to: 1=python, 2=javascript

**Store as**: `language`

**Default**: `python`

---

#### C3: Target Platform

**Question**: "Which platform(s) should this calculator target?"

**Prompt**:
```
Target Platform:
1. linux   - Linux only
2. macos   - macOS only
3. windows - Windows only
4. all     - Cross-platform (recommended)

Enter choice (1-4, default: 4):
```

**Validation**:
- Must be 1-4
- Map to: 1=linux, 2=macos, 3=windows, 4=all

**Store as**: `platform`

**Default**: `all`

---

#### C4: Entry Point Name

**Question**: "What should the main executable be named?"

**Prompt**:
```
Entry Point Name (default: calculator):
Examples: calculator, calc, compute
```

**Validation**:
- Must be alphanumeric (letters, numbers, hyphens, underscores only)
- Length: 1-30 characters

**Store as**: `entry_point`

**Default**: `calculator`

---

#### C5: Interactive Mode

**Question**: "Should interactive mode be included?"

**Prompt**:
```
Include Interactive Mode?
1. yes - Include interactive prompt (recommended)
2. no  - CLI arguments only

Enter choice (1-2, default: 1):
```

**Validation**:
- Must be 1 or 2
- Map to: 1=true, 2=false

**Store as**: `interactive_mode`

**Default**: `true`

---

### 3. Derive Additional Configuration

Based on the language choice, automatically set:

**Test Framework**:
- If `language` == `python`: `test_framework` = `pytest`
- If `language` == `javascript`: `test_framework` = `jest`

**File Extension**:
- If `language` == `python`: `file_ext` = `.py`
- If `language` == `javascript`: `file_ext` = `.js`

---

### 4. Generate BUILD_CONFIG.json

Create `BUILD_CONFIG.json` with the following structure:

```json
{
  "system": "calculator",
  "version": "1.0.0",
  "build_name": "<user_input>",
  "language": "<python|javascript>",
  "platform": "<linux|macos|windows|all>",
  "entry_point": "<user_input>",
  "interactive_mode": <true|false>,
  "test_framework": "<pytest|jest>",
  "file_ext": "<.py|.js>",
  "created_at": "<ISO8601_timestamp>",
  "ybs_version": "2.0.0"
}
```

**Example (Python)**:
```json
{
  "system": "calculator",
  "version": "1.0.0",
  "build_name": "demo",
  "language": "python",
  "platform": "all",
  "entry_point": "calculator",
  "interactive_mode": true,
  "test_framework": "pytest",
  "file_ext": ".py",
  "created_at": "2026-01-18T20:00:00Z",
  "ybs_version": "2.0.0"
}
```

**Example (JavaScript)**:
```json
{
  "system": "calculator",
  "version": "1.0.0",
  "build_name": "build1",
  "language": "javascript",
  "platform": "all",
  "entry_point": "calc",
  "interactive_mode": false,
  "test_framework": "jest",
  "file_ext": ".js",
  "created_at": "2026-01-18T20:00:00Z",
  "ybs_version": "2.0.0"
}
```

---

### 5. Create Initial BUILD_STATUS.md

Create `BUILD_STATUS.md` with initial status:

```markdown
# Build Status: <build_name>

**System**: calculator
**Started**: <ISO8601_timestamp>
**Status**: ðŸ”„ IN PROGRESS

---

## Configuration

- **Build Name**: <build_name>
- **Language**: <language>
- **Platform**: <platform>
- **Entry Point**: <entry_point>
- **Interactive Mode**: <yes|no>
- **Test Framework**: <test_framework>

---

## Steps Progress

- [x] Step 0: Build Configuration (COMPLETE)
- [ ] Step 1: Initialize Project Structure
- [ ] Step 2: Create Calculator Module
- [ ] Step 3: Create Parser Module
- [ ] Step 4: Create Formatter Module
- [ ] Step 5: Create CLI Interface
- [ ] Step 6: Create Unit Tests (Calculator)
- [ ] Step 7: Create Unit Tests (Parser & Formatter)
- [ ] Step 8: Create Integration Tests
- [ ] Step 9: Create Documentation
- [ ] Step 10: Final Verification

---

## Build Log

### Step 0: Build Configuration
- **Started**: <ISO8601_timestamp>
- **Completed**: <ISO8601_timestamp>
- **Duration**: < 1 minute
- **Status**: âœ… PASS
- **Notes**: Configuration collected and saved
```

---

## Verification

### Success Criteria

- âœ… BUILD_CONFIG.json exists and is valid JSON
- âœ… All required fields present in BUILD_CONFIG.json
- âœ… BUILD_STATUS.md created with initial status
- âœ… Configuration values are within valid ranges

### Verification Commands

```bash
# Check BUILD_CONFIG.json exists
test -f BUILD_CONFIG.json && echo "âœ… Config file exists"

# Validate JSON format
python -m json.tool BUILD_CONFIG.json > /dev/null 2>&1 && echo "âœ… Valid JSON"
# OR for Node:
node -e "JSON.parse(require('fs').readFileSync('BUILD_CONFIG.json'))" && echo "âœ… Valid JSON"

# Check BUILD_STATUS.md exists
test -f BUILD_STATUS.md && echo "âœ… Status file exists"

# Display configuration
cat BUILD_CONFIG.json
```

---

## Error Handling

### Common Issues

1. **Invalid JSON syntax**: Re-create BUILD_CONFIG.json with correct syntax
2. **Missing fields**: Ensure all required fields are present
3. **Invalid values**: Validate against allowed ranges

### Recovery

If configuration is invalid:
1. Delete BUILD_CONFIG.json
2. Re-run Step 0
3. Answer questions carefully

---

## Next Step

**Step 1**: Initialize Project Structure (calc-step_478a8c4b0cef.md)

---

## Notes

- This is the ONLY step that asks questions
- All subsequent steps read from BUILD_CONFIG.json
- Configuration enables zero-interaction rebuilds
- If you need to change configuration, delete BUILD_CONFIG.json and re-run Step 0

---

**Traceability**: Implements calculator-spec.md Â§ 4.1 (Build Configuration)
