# Step 000001: Define Architecture & Choose Technology Stack

**Version**: 0.2.0

## Overview

This step helps you make the fundamental architectural decisions that will affect the entire build. You'll choose the programming language and target platform(s). LLM providers will be configurable later via the configuration system.

## Why This Step Matters

These choices affect:
- **Project structure**: Different languages have different conventions
- **Build tools**: Package managers, compilers, test frameworks
- **Dependencies**: Available libraries and their maturity
- **Sandboxing approach**: Platform-specific security mechanisms
- **Distribution**: How users will install and run your system
- **Development speed**: Your familiarity with the language

## Step Objectives

1. Ask user for programming language choice
2. Ask user for target platform(s)
3. Document all choices in BUILD_STATUS.md
4. Create ARCHITECTURE.md file with decisions and rationale
5. Verify documentation
6. Document completion

**Note**: LLM provider selection will be handled later via configuration system (JSON config file), not as an architecture choice.

## Instructions

### 1. Ask for Programming Language

Use the AskUserQuestion tool to ask which language to use.

**Question**: "Which programming language would you like to use for building this coding assistant?"

**Options**:
- **Swift**: Native macOS, fast startup (~10ms), single binary, type-safe. Best for macOS-first. Harder on Linux.
- **Python**: Easiest to start, huge AI/LLM ecosystem (langchain, etc.), slower startup (~200ms). Runtime dependency.
- **Go**: Fast, excellent cross-platform support, simple concurrency, single binary. Good balance.
- **Rust**: Fastest, most memory-safe, steepest learning curve. Best for production-grade systems.
- **TypeScript/Node**: Familiar to many, good async support, requires Node runtime. Large ecosystem.

Store the response in `LANGUAGE` variable.

### 2. Ask for Target Platform(s)

Use the AskUserQuestion tool to ask which platforms to support.

**Question**: "Which platform(s) should this system support?"

**Options**:
- **macOS only**: Simplest, can use macOS-specific features (sandbox-exec, etc.)
- **Linux only**: Good for servers, containers, wide compatibility
- **macOS + Linux**: Most common combination, requires cross-platform approach
- **All platforms (macOS + Linux + Windows)**: Maximum reach, most complexity

Store the response in `PLATFORMS` variable.

### 3. Create ARCHITECTURE.md

Create `builds/SYSTEMNAME/ARCHITECTURE.md` documenting the choices:

```markdown
# Architecture Decisions: SYSTEMNAME

**Version**: 0.1.0
**Decided**: [current timestamp]

## Technology Stack

### Programming Language
**Choice**: LANGUAGE

**Rationale**: [based on user's choice, explain why this makes sense]

**Implications**:
- Project structure: [language-specific structure]
- Build tool: [e.g., Swift Package Manager, pip, cargo, npm, go modules]
- Package manager: [tool name]
- Testing framework: [tool name]

### Target Platform(s)
**Choice**: PLATFORMS

**Rationale**: [based on user's choice]

**Implications**:
- Sandboxing approach: [platform-specific notes]
- Distribution: [how users will install]
- CI/CD: [what to test on]

### LLM Provider Support
**Strategy**: Configurable via JSON configuration file

**Rationale**: LLM providers should be pluggable and user-configurable, not hardcoded architecture decisions. The configuration system (implemented in a later step) will allow users to choose Ollama, OpenAI, Anthropic, or any OpenAI-compatible provider.

**Implications**:
- API abstraction: Provider protocol/interface needed
- Configuration: JSON config with provider, model, endpoint, API key fields
- Dependencies: HTTP client for REST APIs, JSON parsing
- Default: Will default to Ollama (local, no API key) for development

## Implementation Notes

### Language-Specific Details

#### LANGUAGE
- **Build command**: [e.g., swift build, cargo build, npm run build]
- **Test command**: [e.g., swift test, pytest, cargo test, npm test]
- **Run command**: [e.g., swift run, python -m, cargo run, npm start]
- **Package file**: [e.g., Package.swift, pyproject.toml, Cargo.toml, package.json]

### Platform-Specific Details

#### PLATFORMS
- **Sandboxing**: [approach for each platform]
- **File paths**: [considerations for path handling]
- **Shell execution**: [platform-specific notes]

### LLM Integration (Configurable)

- **HTTP client**: [what library to use]
- **API abstraction**: Provider protocol for pluggable backends
- **Configuration**: JSON file with provider, model, endpoint, API key
- **Supported providers**: Ollama, OpenAI, Anthropic, any OpenAI-compatible API
- **Default**: Ollama at http://localhost:11434 (local, no key needed)

## Next Steps

Step 000002 will set up the LANGUAGE project structure with appropriate build tools and initial files.

---

**Reference Documentation**:
- Language chosen: Based on user preference
- Original spec reference: `../../docs/specs/system/ybs-spec.md` (was Swift-specific, adapt as needed)
- Architectural decisions: `../../docs/specs/system/ybs-decisions.md` (reference but adapt)
```

Replace `SYSTEMNAME`, `LANGUAGE`, `PLATFORMS`, `LLM_PROVIDERS`, and timestamps with actual values.

### 4. Update BUILD_STATUS.md

Add architecture section to `builds/SYSTEMNAME/BUILD_STATUS.md`:

```markdown
## Architecture Decisions
- **Language**: LANGUAGE
- **Platform(s)**: PLATFORMS
- **LLM Providers**: Configurable (via config system)
- **Decided**: [timestamp]
- **Details**: See ARCHITECTURE.md
```

Update the status section:
```markdown
**Current Step**: step_000001
**Step Version**: 0.1.0
**Status**: completed
**Last Updated**: [timestamp]

## Current Step Details
- **Title**: Define Architecture & Choose Technology Stack
- **Status**: completed
- **Issues**: none

## Next Action
Ready to proceed to step_000002 (Set up LANGUAGE project structure).
```

### 5. Verify Choices

Run verification to confirm everything is documented:

**Verification Commands**:
```bash
# Verify ARCHITECTURE.md exists
test -f builds/SYSTEMNAME/ARCHITECTURE.md && echo "✓ ARCHITECTURE.md created"

# Show architecture decisions
echo "=== Architecture Decisions ==="
cat builds/SYSTEMNAME/ARCHITECTURE.md

# Verify BUILD_STATUS.md updated
echo "=== BUILD_STATUS.md Architecture Section ==="
grep -A 5 "Architecture Decisions" builds/SYSTEMNAME/BUILD_STATUS.md
```

### 6. Document Completion

Create `builds/SYSTEMNAME/docs/build-history/step_000001-DONE.txt`:

```
STEP 000001: Define Architecture & Choose Technology Stack
COMPLETED: [timestamp]

OBJECTIVES:
- Ask user for programming language choice
- Ask user for target platform(s)
- Document all choices in BUILD_STATUS.md
- Create ARCHITECTURE.md with decisions and rationale
- Verify documentation

ACTIONS TAKEN:
- Asked user for language choice (response: LANGUAGE)
- Asked user for platform choice (response: PLATFORMS)
- Documented that LLM providers will be configurable
- Created ARCHITECTURE.md documenting all decisions
- Updated BUILD_STATUS.md with architecture section
- Verified all documentation created

VERIFICATION RESULTS:
✓ User provided language choice: LANGUAGE
✓ User provided platform choice: PLATFORMS
✓ LLM provider strategy documented (configurable)
✓ ARCHITECTURE.md created with complete documentation
✓ BUILD_STATUS.md updated with architecture decisions
✓ All choices documented and verified

ISSUES ENCOUNTERED:
None

FILES CREATED:
- builds/SYSTEMNAME/ARCHITECTURE.md

FILES MODIFIED:
- builds/SYSTEMNAME/BUILD_STATUS.md

NEXT STEP: step_000002 (Set up LANGUAGE project structure)

ARCHITECTURE LOCKED: Yes
```

Replace placeholders with actual values.

### 8. Report to User

Output a summary message:

```
✓ Step 000001 complete: Architecture & technology stack defined

System: SYSTEMNAME
Language: LANGUAGE
Platform(s): PLATFORMS
LLM Providers: Configurable (via config system)

Documentation:
  ✓ ARCHITECTURE.md created
  ✓ BUILD_STATUS.md updated
  ✓ step_000001-DONE.txt created

Status: ✓ READY FOR STEP 2

Next step: step_000002 (Set up LANGUAGE project structure)
```

## Verification Checklist

Before marking this step complete, verify:

- [ ] User was asked for language choice
- [ ] User was asked for platform choice
- [ ] LLM provider strategy documented (configurable)
- [ ] All choices documented in ARCHITECTURE.md
- [ ] BUILD_STATUS.md updated with architecture section
- [ ] step_000001-DONE.txt created
- [ ] All files contain actual values (no placeholders)
- [ ] User received completion summary

## Success Criteria

This step is successful when:
1. Language and platform questions answered
2. LLM provider strategy documented as configurable
3. ARCHITECTURE.md exists with complete documentation
4. BUILD_STATUS.md contains architecture decisions
5. Documentation file exists in build-history/
6. User knows what's being built and why

## Important Notes

- **These choices are not easily reversible**: Changing language later means starting over
- **No wrong answers**: Each choice has trade-offs; pick what fits your skills and goals
- **LLM providers are configurable**: No need to choose now - config system handles this
- **Platform support**: Can be expanded, but architecture should consider it from the start

---

## Version History

### 0.2.0 (2026-01-16)
- Removed LLM provider selection (now configurable via config system)
- Simplified to language + platform choices only
- LLM providers will be handled in configuration step

### 0.1.0 (2026-01-16)
- Initial version
- Architecture and technology stack selection
- Supports 5 languages, multiple platforms

---

**Step completed?** Proceed to `step_000002.md`
